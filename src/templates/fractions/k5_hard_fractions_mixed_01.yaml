metadata:
  id: k5_hard_fractions_mixed_01
  version: "1.0.0"
  author: Mathbot
  created: 2026-01-30
  grade: 5
  topic: fractions.mixed
  family: fractions_mixed
  difficulty: hard
  steps: 4
  culture: en-US
  tags: [fractions, mixed-number, addition, word-problem]

variables:
  name:
    type: person
  whole1:
    type: integer
    min: 2
    max: 4
  numerator1:
    type: integer
    min: 1
    max: 5
  denominator1:
    type: integer
    min: 4
    max: 8
  whole2:
    type: integer
    min: 1
    max: 3
  numerator2:
    type: integer
    min: 1
    max: 5
  denominator2:
    type: integer
    min: 4
    max: 8
  Answer:
    type: string

template: |
  {{name}} used {{whole1}} {{numerator1}}/{{denominator1}} meters of ribbon on Monday and {{whole2}} {{numerator2}}/{{denominator2}} meters on Tuesday.
  How much ribbon did {{name}} use in total? Express your answer as a mixed number in simplest form.

solution: |
  # Ensure numerators < denominators
  if numerator1 >= denominator1:
      numerator1 = denominator1 - 1
  if numerator2 >= denominator2:
      numerator2 = denominator2 - 1
  
  # Convert mixed numbers to improper fractions
  improper1 = whole1 * denominator1 + numerator1
  improper2 = whole2 * denominator2 + numerator2
  
  # Find LCD
  lcd = math.lcm(denominator1, denominator2)
  
  # Convert to common denominator and add
  new_num1 = improper1 * (lcd // denominator1)
  new_num2 = improper2 * (lcd // denominator2)
  result_numerator = new_num1 + new_num2
  
  # Simplify
  common = math.gcd(result_numerator, lcd)
  final_num = result_numerator // common
  final_den = lcd // common
  
  # Convert to mixed number
  whole_part = final_num // final_den
  remainder = final_num % final_den
  
  if remainder == 0:
      Answer = str(whole_part)
  else:
      Answer = f"{whole_part} {remainder}/{final_den}"

tests:
  - seed: 12345
    expected:
      answer: "5 1/2"
  - seed: 67890
    expected:
      answer: "5 5/8"
  - seed: 77777
    expected:
      answer: "6 1/4"
